# Smartsense Assessment - Email Classification and Response System

## Overview

This repository contains a Gradio-based web application that classifies emails and generates appropriate responses. The system uses a fine-tuned model to categorize emails into the following types:
1. **Student Inquiries**
2. **Academic Collaboration Inquiries**
3. **Corporate Inquiries**

For **student inquiries**, the app uses a Retrieval-Augmented Generation (RAG) system to generate a relevant response by fetching information from a document store. For the other two categories, an autogenerated message is provided, notifying that the email has been forwarded to the Head of Department (HOD).

The app is containerized using Docker, making it easy to deploy across different environments, including cloud services.

## Features

- **Email Classification**: The system can classify emails into one of three types using a fine-tuned model.
- **RAG System**: For student inquiries, a RAG system uses FAISS and Hugging Face embeddings to retrieve relevant information and generate a response.
- **Gradio Interface**: Provides a user-friendly web interface for email classification and response.
- **Dockerized**: The app is containerized, making it portable and easily deployable.

## Requirements

### Docker Requirements
- **GPU Support**: Get the NVIDIA drivers and CUDA toolkit as running models require GPUs.

### Application Dependencies
- **Gradio**: For building the web interface.
- **Hugging Face Transformers**: For loading the fine-tuned email classifier model.
- **LangChain and FAISS**: For document retrieval and question-answering.
- **Unsloth Library**: For loading and running the Lora fine-tuned model.
- **Torch**: For executing the model on CPU or GPU.

## Model Information

The application uses the fine-tuned model from Hugging Face: `anishkarnik/lora_model`. The model is optimized to run in 4-bit precision, making it lightweight for deployment.

## How to Run the Application

## 1. Pull the Docker Image from Docker Hub

The Docker image `anishkarnik/email_classifier_gradio_app:v1` is already built and pushed to Docker Hub. You can pull the image directly using the following command:

```bash
docker pull anishkarnik/email_classifier_gradio_app:v1

docker run -e HUGGINGFACEHUB_API_TOKEN=<your-token> -p 7860:7860 anishkarnik/email_classifier_gradio_app:v1

http://localhost:7860
```
